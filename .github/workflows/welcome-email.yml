name: Send Welcome Email

on:
  repository_dispatch:
    types: [send_welcome_email]

jobs:
  send-welcome:
    runs-on: ubuntu-latest
    steps:
      - name: Send welcome email via SendGrid API
        run: |
          curl -X POST https://api.sendgrid.com/v3/mail/send \
            -H "Authorization: Bearer ${{ secrets.SENDGRID_API_KEY }}" \
            -H "Content-Type: application/json" \
            -d '{
              "personalizations": [{
                "to": [{"email": "${{ github.event.client_payload.email }}"}]
              }],
              "from": {"email": "nathaniel.valdivieso@gmail.com", "name": "burnfolder"},
              "subject": "welcome to burnfolder",
              "content": [{
                "type": "text/plain",
                "value": "thanks for subscribing to burnfolder.\n\nyou'\''ll get an email whenever a new entry is posted.\n\nlatest entries:\n- 8.25\n- 9.20\n- 10.22\n\nvisit: https://burnfolder.netlify.app\n\n---\nburnfolder"
              }]
            }'
